function asyncGeneratorStep(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){return void c(a)}h.done?b(i):Promise.resolve(i).then(d,e)}function _asyncToGenerator(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){function f(a){asyncGeneratorStep(h,d,e,f,g,"next",a)}function g(a){asyncGeneratorStep(h,d,e,f,g,"throw",a)}var h=a.apply(b,c);f(void 0)})}}function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){_defineProperty(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}function _defineProperty(a,b,c){return b=_toPropertyKey(b),b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _toPropertyKey(a){var b=_toPrimitive(a,"string");return"symbol"==typeof b?b:b+""}function _toPrimitive(a,b){if("object"!=typeof a||null===a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var d=c.call(a,b||"default");if("object"!=typeof d)return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}import{r as m,j as v,a as t,F as ve}from"../chunks/chunk-c99e57a5.js";import{u as Ne}from"../chunks/chunk-6c2270a1.js";import{t as Se,s as we,a as Q,b as X,d as ee,c as Ae}from"../chunks/chunk-8af89c92.js";import{B as n,b as M,c as le,s as Me,D as be,g as ye,p as te,d as Re,a as De,u as Pe}from"../chunks/chunk-9462a3a4.js";var ae="/blocka/assets/static/icon.a1ab2e09.png",Oe="/blocka/assets/static/icon.4cd64e05.png",pe=a=>m.createElement("svg",_objectSpread({width:1024,height:1024,viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},a),m.createElement("path",{fill:"currentColor",d:"M195.2 195.2a64 64 0 0 1 90.496 0L512 421.504 738.304 195.2a64 64 0 0 1 90.496 90.496L602.496 512 828.8 738.304a64 64 0 0 1-90.496 90.496L512 602.496 285.696 828.8a64 64 0 0 1-90.496-90.496L421.504 512 195.2 285.696a64 64 0 0 1 0-90.496z"})),Ce=a=>m.createElement("svg",_objectSpread({fill:"currentColor",width:20,height:20,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},a),m.createElement("path",{d:"M21.71,11.29l-9-9a1,1,0,0,0-1.42,0l-9,9a1,1,0,0,0-.21,1.09A1,1,0,0,0,3,13H4v7.3A1.77,1.77,0,0,0,5.83,22H8.5a1,1,0,0,0,1-1V16.1a1,1,0,0,1,1-1h3a1,1,0,0,1,1,1V21a1,1,0,0,0,1,1h2.67A1.77,1.77,0,0,0,20,20.3V13h1a1,1,0,0,0,.92-.62A1,1,0,0,0,21.71,11.29Z"})),Le=a=>m.createElement("svg",_objectSpread({enableBackground:"new 0 0 45.973 45.973",height:45.973,viewBox:"0 0 45.973 45.973",width:45.973,xmlns:"http://www.w3.org/2000/svg"},a),m.createElement("path",{d:"m43.454 18.443h-2.437c-.453-1.766-1.16-3.42-2.082-4.933l1.752-1.756c.473-.473.733-1.104.733-1.774 0-.669-.262-1.301-.733-1.773l-2.92-2.917c-.947-.948-2.602-.947-3.545-.001l-1.826 1.815c-1.496-.872-3.1-1.544-4.867-1.976v-2.608c0-1.383-1.105-2.52-2.488-2.52h-4.128c-1.383 0-2.471 1.137-2.471 2.52v2.607c-1.766.431-3.38 1.104-4.878 1.977l-1.825-1.815c-.946-.948-2.602-.947-3.551-.001l-2.918 2.917c-.468.467-.735 1.113-.735 1.773 0 .669.259 1.299.733 1.772l1.752 1.76c-.921 1.513-1.629 3.167-2.081 4.933h-2.438c-1.384 0-2.501 1.112-2.501 2.492v4.125c0 1.384 1.117 2.471 2.501 2.471h2.438c.452 1.766 1.159 3.43 2.079 4.943l-1.752 1.763c-.474.473-.734 1.106-.734 1.776s.261 1.303.734 1.776l2.92 2.919c.474.473 1.103.733 1.772.733s1.299-.261 1.773-.733l1.833-1.816c1.498.873 3.112 1.545 4.878 1.978v2.604c0 1.383 1.088 2.498 2.471 2.498h4.128c1.383 0 2.488-1.115 2.488-2.498v-2.605c1.767-.432 3.371-1.104 4.869-1.977l1.817 1.812c.474.475 1.104.735 1.775.735.67 0 1.301-.261 1.774-.733l2.92-2.917c.473-.472.732-1.103.734-1.772 0-.67-.262-1.299-.734-1.773l-1.75-1.77c.92-1.514 1.627-3.179 2.08-4.943h2.438c1.383 0 2.52-1.087 2.52-2.471v-4.125c.001-1.38-1.135-2.492-2.518-2.492zm-20.478 12.407c-4.378 0-7.928-3.517-7.928-7.852 0-4.338 3.55-7.85 7.928-7.85 4.379 0 7.931 3.512 7.931 7.85-.001 4.336-3.552 7.852-7.931 7.852z",fill:"currentColor"})),xe="/blocka/assets/static/icon_transparent.58f301db.png";function ke(a){return v("div",{className:"Home",children:[t("img",{alt:Se,className:"Home-logo",src:xe}),v("div",{className:"Home-buttons",children:[t("button",{className:"Home-button Home-button--play"+(a.onPlay?"":" Home-button--hidden"),onClick:a.onPlay,children:"Continue Game"}),t("button",{className:"Home-button Home-button--newgame"+(a.onNewGame?"":" Home-button--hidden"),onClick:a.onNewGame,children:"New Game"})]})]})}var Ge=a=>m.createElement("svg",_objectSpread({fill:"currentColor",height:20,width:20,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},a),m.createElement("path",{d:"M306.842,315.552l-2.851,1.522c-15.427,8.218-31.586,12.384-48.028,12.384 c-16.392,0-32.525-4.166-47.952-12.384l-2.851-1.522l16.66,99.146h68.364L306.842,315.552z"}),m.createElement("polygon",{points:"195.816,434.616 175.874,487.582 336.128,487.582 316.186,434.616"}),m.createElement("path",{d:"M421.452,43.222c0.21-5.695,0.35-11.425,0.35-17.213v-1.592H90.2v1.592c0,5.788,0.14,11.518,0.35,17.213H0 v23.401c0,102.768,70.767,186.378,157.751,186.378l0.31-0.012c28.552,35.497,62.407,54.258,97.941,54.258 c35.742,0,69.781-18.979,98.249-54.247c86.984,0,157.749-83.61,157.749-186.378V43.222H421.452z M283.892,157.605l17.238,53.051 l-45.128-32.787l-45.128,32.787l17.236-53.051l-45.128-32.788h55.782l17.238-53.055l17.238,53.055h55.78L283.892,157.605z M48.354,90.02h46.204c5.485,39.992,16.262,77.978,31.25,110.21C85.48,184.962,55.394,142.275,48.354,90.02z M386.194,200.229 c14.988-32.224,25.763-70.214,31.25-110.21h46.204C456.608,142.275,426.522,184.962,386.194,200.229z"}));function oe(b){var d,e,f=b.pieceData.length,c=Math.max(...b.pieceData.map(a=>a.length)),a=Array.from({length:f},(a,e)=>Array.from({length:c},(a,c)=>{var d;return null!==(d=b.pieceData[e][c])&&void 0!==d?d:n.EMPTY})),g=null!==(d=b.gridSize)&&void 0!==d?d:Math.max(f,c);return t("div",_objectSpread(_objectSpread({},b.additionalProperties),{},{className:"Piece ".concat(null!==(e=b.className)&&void 0!==e?e:""),style:_objectSpread(_objectSpread({},b.additionalStyles),{},{gap:"".concat(100/(f/M+f-1),"% ").concat(100/(c/M+c-1),"%"),gridTemplate:"repeat(".concat(f,", 1fr) / repeat(").concat(c,", 1fr)"),height:b.blockSize?"".concat(b.blockSize*(f+(f-1)*M),"px"):"".concat(100*(f+(f-1)*M)/(g+(g-1)*M),"%"),width:b.blockSize?"".concat(b.blockSize*(c+(c-1)*M),"px"):"".concat(100*(c+(c-1)*M)/(g+(g-1)*M),"%")}),children:a.map((a,b)=>a.map((a,c)=>t("div",{className:"Piece-cell",children:t(le,{type:a})},"".concat(b,",").concat(c))))}))}function Ee(a){return a.reduce((b,c)=>b+c.reduce((a,b)=>a+Me[b],0),0)}function re(b,a){return b+=a,()=>{var c=b+=1831565813;return c=Math.imul(c^c>>>15,1|c),c^=c+Math.imul(c^c>>>7,61|c),((c^c>>>14)>>>0)/4294967296}}function me(b,d){var c=re(d,60454930);return Array.from({length:b},()=>H[Math.floor(c()*H.length)])}function de(a){return{highScore:null==a?void 0:a.highScore,seed:he()}}function he(a){return 4294967296*re(null!==a&&void 0!==a?a:Math.floor(4294967296*Math.random()),34729475)()}function w(b){var e=1<arguments.length&&arguments[1]!==void 0?arguments[1]:1,c=Math.floor(e);if(0>c||3<c)return w(b,(c%4+4)%4);if(0===c)return b;for(var a=Math.max(...b.map(a=>a.length)),f=[],g=0;g<a;g++){f.push([]);for(var h=0;h<b.length;h++){var i;f[g].push(null!==(i=b[b.length-h-1][g])&&void 0!==i?i:n.EMPTY)}}return w(f,c-1)}var $=10,R=3,Be=[[n.NORMAL]],$e=[[n.NORMAL,n.NORMAL],[n.NORMAL,n.NORMAL]],He=[[n.NORMAL,n.NORMAL,n.NORMAL],[n.NORMAL,n.NORMAL,n.NORMAL],[n.NORMAL,n.NORMAL,n.NORMAL]],ne=[[n.NORMAL,n.NORMAL]],ce=[[n.NORMAL,n.NORMAL,n.NORMAL]],se=[[n.NORMAL,n.NORMAL,n.NORMAL,n.NORMAL]],ie=[[n.NORMAL,n.NORMAL,n.NORMAL,n.NORMAL,n.NORMAL]],p=[[n.NORMAL,n.EMPTY],[n.NORMAL,n.NORMAL]],C=[[n.NORMAL,n.EMPTY,n.EMPTY],[n.NORMAL,n.EMPTY,n.EMPTY],[n.NORMAL,n.NORMAL,n.NORMAL]],H=[Be,$e,He,ne,w(ne),ce,w(ce),se,w(se),ie,w(ie),p,w(p),w(p,2),w(p,3),C,w(C),w(C,2),w(C,3)],ze=Math.max(...H.map(a=>Math.max(a.length,...a.map(a=>a.length))));function Te(b){function e(){c(null),i(null),l(null)}var h,j,k,o,p,q,s,[u,c]=m.useState(null),[a,i]=m.useState(null),[r,l]=m.useState(null),[d,g]=m.useState(new Set),f=m.useRef(),w=a?(a[0].length-1)*(null!==(h=null==(o=f.current)?void 0:o.offsetWidth)&&void 0!==h?h:0)/2:0;return v("div",{className:"Game",style:{"--board-size":$,"--num-pieces":R},children:[t("div",{className:"Game-header",children:v("div",{className:"Game-scores",children:[t("div",{className:"Game-score Game-score--current",children:t("span",{className:"Game-scoreValue",children:(null!==(j=null==(p=b.gameData)?void 0:p.score)&&void 0!==j?j:0).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")})}),v("div",{className:"Game-score Game-score--best",children:[t(Ge,{className:"Game-scoreIcon",title:"High Score"}),t("span",{className:"Game-scoreValue",children:(null!==(k=null==(q=b.gameData)?void 0:q.highScore)&&void 0!==k?k:0).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")})]})]})}),t("div",{className:"Game-main",children:v(be,{onDragCancel:e,onDragEnd:c=>{var d,f,h,i,l,m,o;if(a&&null!=(d=c.over)&&d.data.current){var p=ye($,null==(f=b.gameData)?void 0:f.boardState),v=[];if(te(p,a,{colNum:c.over.data.current.colNum,rowNum:c.over.data.current.rowNum})){var s,u;a.forEach((b,d)=>b.forEach((e,f)=>{if(e!==n.EMPTY){var g=c.over.data.current.rowNum-a.length+d+1,h=c.over.data.current.colNum-b.length+f+1;p[g][h]=e,v.push({colNum:h,rowNum:g})}}));var w=Array.from({length:R},(a,c)=>{var d,e;return!!(null!=(e=null==(d=b.gameData)?void 0:d.piecesUsed)&&e[c])||c===r}),q=w.every(a=>a),x=q||null==(null==(h=b.gameData)?void 0:h.seed)?he(null==(i=b.gameData)?void 0:i.seed):b.gameData.seed,y=(null!==(s=null==(l=b.gameData)?void 0:l.score)&&void 0!==s?s:0)+Ee(a),z=p.map((a,b)=>({row:a,rowNum:b})).filter(a=>{var{row:b}=a;return b.every(a=>a!==n.EMPTY)}).map(a=>{var{rowNum:b}=a;return b}),k=p[0].map((a,b)=>({col:p.map(a=>a[b]),colNum:b})).filter(a=>{var{col:b}=a;return b.every(a=>a!==n.EMPTY)}).map(a=>{var{colNum:b}=a;return b}),A=v.filter(a=>{var{rowNum:b}=a;return z.includes(b)}),B=v.filter(a=>{var{colNum:b}=a;return k.includes(b)}),C=[],F=[];z.forEach(a=>{C.push(...p[a].map((b,c)=>({rowNum:a,colNum:c})))}),k.forEach(a=>p.forEach((b,c)=>{z.includes(c)||C.push({rowNum:c,colNum:a})})),C.forEach(a=>{var{rowNum:c,colNum:d}=a;if(!b.disableAnimations){var e=Math.min(...A.filter(a=>{var{rowNum:b}=a;return c===b}).map(a=>{var{colNum:b}=a;return Math.abs(d-b)}),...B.filter(a=>{var{colNum:b}=a;return d===b}).map(a=>{var{rowNum:b}=a;return Math.abs(c-b)}));F.push({colNum:d,content:t("div",{className:"Game-clearedBlockOverlay",style:{animationDelay:"".concat(.1*e,"s")},children:t(le,{type:p[c][d]})}),key:"".concat(c,",").concat(d,",").concat(r,",").concat(x),rowNum:c})}p[c][d]=n.EMPTY}),F.length&&g(new Set([...F]));var E={boardState:p,highScore:Math.max(null!==(u=null==(m=b.gameData)?void 0:m.highScore)&&void 0!==u?u:0,y),piecesUsed:q?Array.from({length:R},()=>!1):w,score:y,seed:x};null==(o=b.onSave)||o.call(b,E),me(R,E.seed).every((a,b)=>E.piecesUsed[b]||p.every((b,c)=>b.every((b,d)=>!te(p,a,{rowNum:c,colNum:d}))))&&window.setTimeout(()=>{var a;window.confirm("No more moves! Start a new game?")&&(null==(a=b.onSave)||a.call(b,de(E)))},1500)}}e()},onDragOver:a=>{var d;return c(null!=(d=a.over)&&d.data.current?{colNum:a.over.data.current.colNum,rowNum:a.over.data.current.rowNum}:null)},onDragStart:a=>{var c,d,e,f;i(null!==(c=null==(e=a.active.data.current)?void 0:e.pieceData)&&void 0!==c?c:null),l(null!==(d=null==(f=a.active.data.current)?void 0:f.pieceIndex)&&void 0!==d?d:null)},children:[t(Ie,{activeCell:u,boardCellOverlays:d,boardCellRef:f,activePiece:a,gameData:b.gameData}),t(Re,{dropAnimation:b.disableAnimations?null:void 0,children:a&&f.current&&t("div",{className:"Game-activePieceWrapper",style:{left:"calc(".concat(1*w+M,"px - 50%)")},children:t(oe,{blockSize:null==(s=f.current)?void 0:s.offsetWidth,className:"Game-activePiece",pieceData:a})})})]})})]})}function Ie(b){var d,e,h=null!=(d=b.gameData)&&d.seed?me(R,b.gameData.seed):[];return v(ve,{children:[t(De,{activeCell:b.activeCell,cellOverlays:b.boardCellOverlays,cellRef:b.boardCellRef,className:"Game-board",activePiece:b.activePiece,size:$,state:null==(e=b.gameData)?void 0:e.boardState}),t("div",{className:"Game-pieces",children:Array.from({length:R},(a,c)=>{var e,i,j;return(null==(e=b.gameData)?void 0:e.seed)&&h[c]&&t(Ye,{boardCellRef:b.boardCellRef,id:"piece-".concat(c,"-").concat(b.gameData.seed),pieceData:h[c],pieceIndex:c,used:null==(j=null==(i=b.gameData)?void 0:i.piecesUsed)?void 0:j[c]},c)})})]})}function Ye(b){var e,f,{attributes:h,isDragging:c,listeners:a,setActivatorNodeRef:i,setNodeRef:j}=Pe({attributes:{roleDescription:"Draggable piece"},data:{pieceData:b.pieceData,pieceIndex:b.pieceIndex},id:b.id});return t("div",{className:"Game-pieceSlot",children:!b.used&&v("div",_objectSpread(_objectSpread(_objectSpread({className:"Game-pieceWrapper",ref:i},h),a),{},{children:[t("div",{className:"Game-pieceDragAnchor",ref:j,style:{height:null==(e=b.boardCellRef.current)?void 0:e.offsetHeight,width:null==(f=b.boardCellRef.current)?void 0:f.offsetWidth}}),!c&&t(oe,{className:"Game-piece",gridSize:ze,pieceData:b.pieceData})]}))})}function Ve(a){return v("div",{className:"SettingsPage",children:[t("form",{className:"SettingsPage-form",children:t(_e,{checked:!a.settings.disableAnimations,label:"Animations",onChange:b=>a.onChange({disableAnimations:!b})})}),t("div",{className:"SettingsPage-buttons",children:t("button",{className:"SettingsPage-button",onClick:()=>{window.confirm("Reset your high score to 0?")&&a.onResetHighScore()},children:"Reset High Score"})})]})}function _e(a){return v("label",{className:"SettingsPage-setting SettingsPage-setting--checkbox",children:[t("input",{checked:!!a.checked,className:"SettingsPage-checkbox",onChange:b=>a.onChange(b.target.checked),type:"checkbox"}),t("span",{className:"SettingsPage-label",children:a.label})]})}function je(a){return a&&"object"==typeof a&&"version"in a&&Object.entries(a).every(b=>{var[d,c]=b;return"gameData"===d?c&&"object"==typeof c:"settings"===d?c&&"object"==typeof c:!("version"!==d)&&1===c})}var ge="blocka";function Ue(){return _Ue.apply(this,arguments)}function _Ue(){return _Ue=_asyncToGenerator(function*(){var a=window.localStorage.getItem(ge);if(a){var b=JSON.parse(a);if(je(b))return b;console.warn("The saved data was in an unknown format. Starting with new data instead.")}return{version:1}}),_Ue.apply(this,arguments)}function We(){function b(){window.localStorage.setItem(ge,JSON.stringify({gameData:c,settings:i,version:1}))}var[h,e]=m.useState(!1),[c,a]=m.useState({}),[i,j]=m.useState({}),[k,d]=m.useState(!0),[g,f]=m.useState(!1);return m.useEffect(()=>{Ue().then(b=>{var d,e;a(null!==(d=b.gameData)&&void 0!==d?d:c),j(null!==(e=b.settings)&&void 0!==e?e:i)}).finally(()=>e(!0))},[]),m.useEffect(()=>{h&&b()},[c,i]),v("div",{className:"App"+(h?" is-loaded":"")+(k?" is-showing-home":"")+(g?" is-showing-settings":""),children:[v("header",{className:"App-header",children:[!k&&t("button",{"aria-label":"Home",className:"App-levelselectButton",onClick:()=>d(!0),children:t(Ce,{className:"App-levelselectButtonIcon"})}),h&&t("button",{"aria-label":g?"Close settings":"Settings",className:"App-settingsButton",onClick:()=>f(!g),children:g?t(pe,{className:"App-settingsButtonIcon"}):t(Le,{className:"App-settingsButtonIcon"})})]}),t("div",{className:"App-home",children:t(ke,{onNewGame:h?()=>{(!c.score||window.confirm("End your current game and start a new one?"))&&(a(de(c)),d(!1))}:void 0,onPlay:h&&c.score?()=>d(!1):void 0})}),t("div",{className:"App-settings",children:t(Ve,{onChange:a=>j(_objectSpread(_objectSpread({},i),a)),onResetHighScore:()=>a(_objectSpread(_objectSpread({},c),{},{highScore:0})),settings:i})}),t("div",{className:"App-level",children:t(Te,{disableAnimations:i.disableAnimations,onSave:a,gameData:c})})]})}function Qe(){var{urlPathname:a}=Ne(),b="https://".concat(we).concat(Q).concat(a.replace(/^\//,""));return v("head",{children:[t("meta",{httpEquiv:"Content-Type",content:"text/html;charset=utf-8"}),t("meta",{name:"viewport",content:"width=device-width,initial-scale=1"}),t("title",{children:X}),t("meta",{name:"description",content:ee}),t("link",{rel:"shortcut icon",href:ae}),t("link",{rel:"apple-touch-icon",href:Oe}),t("meta",{name:"theme-color",content:Ae}),t("link",{rel:"manifest",href:Q+"webmanifest.json"}),t("link",{rel:"canonical",href:b}),t("meta",{property:"og:title",content:X}),t("meta",{property:"og:description",content:ee}),t("meta",{property:"og:image",content:ae}),t("meta",{property:"og:type",content:"website"}),t("meta",{property:"og:url",content:b}),t("meta",{name:"twitter:card",content:"summary"})]})}function Xe(){return t(We,{})}export{Xe as Page,Qe as PageHead};